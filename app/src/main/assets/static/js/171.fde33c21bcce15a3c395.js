webpackJsonp([171],{"0Fmw":function(t,a){},"4kbQ":function(t,a,i){t.exports=i.p+"static/img/virtual_tip.png"},"8V86":function(t,a,i){t.exports=i.p+"static/img/active.png"},Cdpr:function(t,a,i){"use strict";var r=i("HzJ8"),s=i.n(r),e=i("JGLT"),n=i("CKVb"),o=i("gpPJ"),c=i("fvyU"),u=i("IXui");a.a={name:"virtualCard",components:{Confirm:e.a,Group:n.a,Cell:o.a,XInput:c.a,XButton:u.a},data:function(){return{show:!1,show2:!1,isShow:!0,imgURL:[i("8V86"),i("ez+h")],inputPwd:"",currentIndex:"",pageParams:this.$route.params,virtualCardInfo:[]}},computed:{getUserInfo:function(){return this.$store.getters.getStateKey("WL-Authentication-Success.UserInfoAuthRealm.attributes.data").data}},methods:{toAddCard:function(){this.$router.push({name:"cdbank_add_credit"})},getParams:function(){this.virtualCardInfo=this.pageParams.virtualCardInfo,this.virtualCardInfo.length>=1?this.getVirtualCardInfo(this.virtualCardInfo):this.isShow=!1},getVirtualCardInfo:function(t){for(var a=0;a<t.length;a++){if(void 0===t[a].status){var i=!0,r=!1,e=void 0;try{for(var n,o=s()(t);!(i=(n=o.next()).done);i=!0){var c=n.value;this.$set(c,"status",0),this.$set(c,"imgShow",!1),this.$set(c,"tabShow",!1),this.$set(c,"CVV2Show",!1),this.$set(c,"bgShow",0)}}catch(t){r=!0,e=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw e}}}var u=this.isFreeCard(t[a]);t[a].CVV2&&t[a].virtualCardNo&&u?(t[a].imgShow=!1,t[a].tabShow=!1,t[a].CVV2Show=!0):t[a].CVV2&&t[a].virtualCardNo?(t[a].imgShow=!0,t[a].tabShow=!0,t[a].CVV2Show=!0,t[a].status=0):t[a].virtualCardNo&&(t[a].imgShow=!0,t[a].tabShow=!0,t[a].CVV2Show=!1,t[a].status=1,t[a].bgShow=1)}},isFreeCard:function(t){for(var a=this.getUserInfo.freeLoansCardList||[],i=t.virtualCardNo,r=0;r<a.length;r++)if(a[r].accountNo==i)return!0;return!1},getLocalTime:function(){var t=this;window.client.request({ifpUrl:"/mp/MP0002.do",url:"/api/getLocalTime.json",success:function(a){t.localtime=a.currentTime}})},searchCVV2:function(t){var a=this,i=this.currentIndex,r=this.pageParams.virtualCardInfo[i],s={tranCode:"MH0238",srcChannel:"MH",mobileNo:this.getUserInfo.mobileNo,accountNo:this.pageParams.accountNo,virtualCardNo:r.virtualCardNo,effectDate:r.effectDate,customerId:this.getUserInfo.customerId,accPassword:this.inputPwd};window.client.request({ifpUrl:"/mp/MP1202.do",url:"/api/MH0238.json",isLogin:!0,adapter:"CommonAdapter",funName:"second_MH0238",parameters:s,encrypt:!0,processException:function(t){"CW0000IS"==t.errorCode&&a.$vux.toast.show({text:"提现密码错误，请重新输入",type:"text"})},success:function(t){a.getLocalTime(),s.transferFlowNoNew="MH"+a.localtime+"search";var i=t.CVV2;r.status=0,r.CVV2Show=!0,r.CVV2=i,r.bgShow=0}})},checkVirtuaCardNo:function(t){var a=this.getUserInfo.creditCardList.concat(this.getUserInfo.freeLoansCardList),i=!1,r=!0,e=!1,n=void 0;try{for(var o,c=s()(a);!(r=(o=c.next()).done);r=!0){var u=o.value;t.virtualCardNo==u.accountNo&&(i=!0)}}catch(t){e=!0,n=t}finally{try{!r&&c.return&&c.return()}finally{if(e)throw n}}i||(this.show=!0)},findOractive:function(t,a){this.inputPwd="",this.currentIndex=a,1==this.virtualCardInfo[a].status?this.show2=!0:(this.$router.push({name:"virtual_card_tradingRecord",params:param}),console.log("带着虚拟卡标志跳转激活卡片页面"))},tradeRecord:function(t){var a=t;a.virtual="virtual_card",this.checkVirtuaCardNo(t),1!=this.show&&this.$router.push({name:"virtual_card_tradingRecord",params:a})},safeGuardSet:function(t){var a=t;this.checkVirtuaCardNo(t),this.$router.push({name:"cdbank_security_center",params:a})}},watch:{inputPwd:function(){6==this.inputPwd.length&&(this.show2=!1,this.searchCVV2(this.inputPwd))}},filters:{protect:function(t){var a=/^(13[0-9]|15[7-9]|15[0-2]|18[6-9])[0-9]{8}$/,i=/[\u4e00-\u9fa5]+$/,r=/^(\d{4})\d+(\d{4}$)/,s=/^(\d{3})\d+(\d{4}$)/,e=/^([\u4e00-\u9fa5])[\u4e00-\u9fa5]+$/;return t.length>8?String(t).replace(a.test(t)?s:r,function(t,a,i){return a+"****"+i}):i.test(t)?t.replace(e,function(t,a,i){return a+"**"}):t},format:function(t){if(t)return t.substring(4,8)}},created:function(){this.getParams()}}},IPV6:function(t,a,i){"use strict";var r=i("HzJ8"),s=i.n(r),e=i("JGLT"),n=i("CKVb"),o=i("gpPJ"),c=i("fvyU"),u=i("IXui");e.a,n.a,o.a,c.a,u.a},"ez+h":function(t,a,i){t.exports=i.p+"static/img/find.png"},nWPL:function(t,a,i){t.exports=i.p+"static/img/guangfalogo.png"},p5Tn:function(t,a,i){"use strict";var r=function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("xcgb-box",[r("xcgb-head",{attrs:{title:"虚拟卡",keepAlive:!1,leftOptions:[{type:"left_arrow_red"}]}}),t._v(" "),r("div",{staticClass:"main"},[r("confirm",{staticClass:"confirm-init",model:{value:t.show2,callback:function(a){t.show2=a},expression:"show2"}},[r("p",{staticClass:"confirm-tit"},[t._v(t._s(t.pageParams.cardSpecies))]),t._v(" "),r("p",{staticClass:"confirm-tip"},[t._v("请输入提现密码")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.inputPwd,expression:"inputPwd"}],staticClass:"confirm-input",attrs:{type:"password",maxlength:"6"},domProps:{value:t.inputPwd},on:{input:function(a){a.target.composing||(t.inputPwd=a.target.value)}}})]),t._v(" "),r("confirm",{on:{"on-confirm":t.toAddCard},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[r("div",{staticClass:"confirm-hint"},[r("p",[t._v("该卡尚未加挂，无法进行操作，请先加挂！")])])]),t._v(" "),t.isShow?r("div",{staticClass:"tip"},[r("img",{attrs:{src:i("4kbQ")}}),t._v(" "),r("span",[t._v("为保障您的用卡安全，请勿向他人展示本页面")])]):r("div",{staticClass:"noResult"},[r("img",{attrs:{src:i("nWPL")}}),t._v(" "),r("p",[t._v("没有记录")])]),t._v(" "),t._l(t.virtualCardInfo,function(a,i){return r("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"virtual-list",class:[a.bgShow?"bg-blue":"bg-red"]},[r("div",{staticClass:"virtual-account"},[r("span",[t._v(t._s(t._f("protect")(a.virtualCardNo,a.virtualCardNo)))]),t._v(" "),r("img",{directives:[{name:"show",rawName:"v-show",value:a.imgShow,expression:"item.imgShow"}],attrs:{src:t.imgURL[a.status]},on:{click:function(r){t.findOractive(a,i)}}})]),t._v(" "),r("div",{staticClass:"virtual-info"},[r("span",{staticClass:"virtual-tit"},[t._v("有效期")]),r("span",{staticClass:"virtual-cot"},[t._v(t._s(t._f("format")(a.effectDate,a.effectDate)))])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:a.CVV2Show,expression:"item.CVV2Show"}],staticClass:"virtual-info virtual-info-copy"},[r("span",{staticClass:"virtual-tit"},[t._v("CVV2")]),r("span",{staticClass:"virtual-cot"},[t._v(t._s(a.CVV2))])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:a.tabShow,expression:"item.tabShow"}],staticClass:"virtual-tab"},[r("span",{on:{click:function(i){t.tradeRecord(a)}}},[t._v("交易明细")]),r("span",{on:{click:function(i){t.safeGuardSet(a)}}},[t._v("安全设置")])])])})],2)],1)},s=[],e={render:r,staticRenderFns:s};a.a=e},phcE:function(t,a,i){"use strict";function r(t){i("0Fmw")}Object.defineProperty(a,"__esModule",{value:!0});var s=(i("IPV6"),i("Cdpr")),e=i("p5Tn"),n=i("C7Lr"),o=r,c=n(s.a,e.a,!1,o,null,null);a.default=c.exports}});