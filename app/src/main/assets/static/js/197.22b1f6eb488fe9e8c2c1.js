webpackJsonp([197],{"5ZdK":function(t,e,s){t.exports=s.p+"static/img/failSign.png"},"8lvV":function(t,e,s){"use strict";var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("xcgb-box",[o("xcgb-head",{attrs:{keepAlive:!1,title:"绑定扣款卡片",leftOptions:[{type:"left_arrow_black"}]}}),t._v(" "),o("div",{staticClass:"main"},[o("group",{attrs:{title:"仅限您名下的本行借记卡账户"}},[o("x-input",{attrs:{max:20,min:15,placeholder:"请输入您的卡号"},on:{"on-focus":t.showNumKeyBoard,"on-blur":t.checkCardNo},model:{value:t.cardNo,callback:function(e){t.cardNo=e},expression:"cardNo"}},[o("img",{staticClass:"weui-vcode-img",attrs:{slot:"right",src:s("gBdB")},on:{click:t.getCode},slot:"right"})])],1),t._v(" "),o("group",{staticClass:"user_info"},[o("cell",{attrs:{"text-align":"left","value-align":"left",title:"所属银行"}},[t._v(t._s(t.bank))]),t._v(" "),o("cell",{attrs:{"text-align":"left","value-align":"left",title:"开户名"}},[t._v(t._s(t._f("getSurname")(t.userName)))])],1),t._v(" "),o("x-button",{attrs:{type:[t.bindButton?"default":"warn"],"action-type":"button",disabled:t.bindButton},nativeOn:{click:function(e){return t.bindCard(e)}}},[t._v("确认绑定")]),t._v(" "),o("x-dialog",{attrs:{show:t.show}},[o("div",{staticClass:"dislog-head"},[t._v("确认添加转出账户")]),t._v(" "),o("div",{staticClass:"rollout-card-info"},[t._v("\n\t      \t  \t\t转出账户\n\t      \t  \t\t"),o("span",[t._v(t._s(t.cardType)+", "+t._s(t.cardNoFormat(t.cardNo)))])]),t._v(" "),o("img",{staticClass:"dialog-img-close",attrs:{src:s("uZk5")},on:{click:function(e){t.show=!1}}}),t._v(" "),o("img",{staticClass:"dialog-img-sign",attrs:{src:s("5ZdK")}}),t._v(" "),o("div",{staticClass:"pass-word-input"},[o("div",{staticClass:"desc"},[t._v("请输入提现密码")]),t._v(" "),o("label",{attrs:{for:"pass"}},[o("div",{staticClass:"psycontainer"},t._l(t.passBox,function(e){return o("div",{staticClass:"charCell"},[t._v("\n                "+t._s(e)+"\n              ")])})),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"hidden",attrs:{id:"pass",type:"number",autocomplete:"off"},domProps:{value:t.password},on:{keypress:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.nextRequest(e):null},input:function(e){e.target.composing||(t.password=e.target.value)}}})])])])],1)],1)},a=[],n={render:o,staticRenderFns:a};e.a=n},Kwqk:function(t,e,s){"use strict";var o=s("CKVb"),a=s("gpPJ"),n=s("fvyU"),i=s("IXui"),r=s("jHHs"),c=s("Jp5S"),u=s("rZp9");o.a,a.a,n.a,i.a,r.a,u.a,c.a},bGki:function(t,e,s){"use strict";var o=s("CKVb"),a=s("gpPJ"),n=s("fvyU"),i=s("IXui"),r=s("jHHs"),c=s("Jp5S"),u=s("rZp9");e.a={name:"addRollin",data:function(){return{cardType:"本行卡",cardNo:"",bank:"",userName:"",password:"",show:!1}},computed:{passBox:function(){if(this.password.length<1)return["","","","","",""];if(this.password.length>6)return this.password=this.password.slice(0,6),this.password.match(/(\d{1})/g).fill("·");this.password=this.password.slice(0,7);var t=this.password.match(/(\d{1})/g).fill("·");return t=t.concat(new Array(6-t.length)).slice(0,6)},bindButton:function(){var t=this.cardNo;return!(t.match("[0-9]")&&t.length>=16)},getUserInfo:function(){return this.$store.getters.getStateKey("WL-Authentication-Success.UserInfoAuthRealm.attributes.data")}},methods:{init:function(){this.getMessage()},getMessage:function(){this.bank=this.$route.params.bankName||"广发银行",this.userName=this.getUserInfo.data.customerNameCN},goBack:function(){window.client.goBack()},getCode:function(){console.log("调用相机扫描号码")},showNumKeyBoard:function(){console.log("调用数字键盘")},hideNumKeyBoard:function(){console.log("隐藏数字键盘")},showDialog:function(){this.show=!0},showToastFunc:function(t){this.showToast=!0,this.toastText="msg"},bindCard:function(){this.showDialog()},nextRequest:function(){var t=this;console.log("密码",this.password),this.show=!1;var e=this.cardNo,s=this.getUserInfo,o={tranCode:"MH0063",customerId:s.customerId,accountNo:e,pwd:password};this.$vux.loading.show({text:"Loading"}),window.client.request({url:"/api/MH0063.json",adapter:"CommonAdapter",procedure:"MH0063",parameters:o,success:function(e){var s=e.invocationResult;t.$vux.loading.hide();var o=s.root;"0"==o.ec?(t.$vux.toast.show({text:"添加成功！",type:"text",width:"4rem"}),setTimeout(function(){t.goBack},2e3),t.updateDebitCardSession(o,t.cardNo)):t.$vux.toast.show({text:""+o.em,type:"text",width:"4rem"})}})},cardNoFormat:function(t){if(""!==t){var e=t;return e.substring(0,4)+" **** "+e.slice(-4)}},cardimformationLoad:function(t){var e=this.getUserInfo.data,s=e.creditCardList;if(""!=s&&void 0!=s)for(var o=0;o<s.length;o++)s[o].accountNo==t&&(this.cardType=s[o].cardType)},checkCardNo:function(){this.hideNumKeyBoard();var t=this.cardNo;console.log("卡号",t),""!=t&&null!=t&&0!=t.length&&t&&"undefined"!=t?t.match("[0-9]")?t.match('[#\\~\\$\\@\\!\\*\\^\\<\\>\\"%\\&]')?this.$vux.toast.show({text:"卡号只能为数字，请重新输入",type:"text",width:"4rem"}):t.length<16&&this.$vux.toast.show({text:"卡号不能低于16位，请重新输入",type:"text",width:"4rem"}):this.$vux.toast.show({text:"卡号只能为数字，请重新输入",type:"text",width:"4rem"}):this.$vux.toast.show({text:"卡号不能为空",type:"text",width:"4rem"}),this.cardimformationLoad(t)},updateDebitCardSession:function(t,e){console.log("更新借记卡信息",t,e);var s=[],o=this.getUserInfo.data;console.log("用户信息",o);var a=o.cardList.length;console.log(a),t.cd&&t.cd.result&&t.cd.result.kColl&&void 0!=t.cd.result.kColl.accountNo?s.push(t.cd.result.kColl):s=t.cd.result.kColl;for(var n=0;n<s.length;n++)if(s[n].accountNo==e){var i={accountAlias:s[n].accountAlias,accountName:s[n].accountName,accountNo:s[n].accountNo,accountType:s[n].accountType,cardType:"",currencyType:s[n].currencyType,isDefaultAccNo:s[n].isDefaultAccNo,isNew:"",isOpenPay:s[n].isOpenPay,masterAttachedCardFlag:"",newYHTAccNo:"",oaPhonePay:s[n].oaPhonePay,oaPrivilege:s[n].oaPrivilege,openBranch:s[n].openBranch,openNode:s[n].openNode,sourceSys:"",specialCardFlag:"",subAccountNo:s[n].subAccountNo};return o.cardList.splice(a,0,i),void console.log("更新后的session",o)}}},components:{Group:o.a,Cell:a.a,XInput:n.a,XButton:i.a,XDialog:r.a},filters:{getSurname:u.a},directives:{TransferDom:c.a},mounted:function(){this.init()}}},bO39:function(t,e){},gn2h:function(t,e,s){"use strict";function o(t){s("bO39")}Object.defineProperty(e,"__esModule",{value:!0});var a=(s("Kwqk"),s("bGki")),n=s("8lvV"),i=s("C7Lr"),r=o,c=i(a.a,n.a,!1,r,null,null);e.default=c.exports},rZp9:function(t,e,s){"use strict";function o(t){return["欧阳","太史","端木","上官","司马","东方","独孤","南宫","万俟","闻人","夏侯","诸葛","尉迟","公羊","赫连","澹台","皇甫","宗政","濮阳","公冶","太叔","申屠","公孙","慕容","仲孙","钟离","长孙","宇文","司徒","鲜于","司空","闾丘","子车","亓官","司寇","巫马","公西","颛孙","壤驷","公良","漆雕","乐正","宰父","谷梁","拓跋","夹谷","轩辕","令狐","段干","百里","呼延","东郭","南门","羊舌","微生","公户","公玉","公仪","梁丘","公仲","公上","公门","公山","公坚","左丘","公伯","西门","公祖","第五","公乘","贯丘","公皙","南荣","东里","东宫","仲长","子书","子桑","即墨","达奚","褚师"].some(function(e){return e==t.substr(0,2)})?t.substr(0,2)+"*":""!==t&&void 0!==t?t.charAt(0)+"*":void 0}e.a=o},uZk5:function(t,e,s){t.exports=s.p+"static/img/nav_icon_close.png"}});