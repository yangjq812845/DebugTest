webpackJsonp([312],{Kaep:function(e,t,o){"use strict";var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("xcgb-box",[o("xcgb-head",{attrs:{title:"红包调额",keepAlive:!1,leftOptions:[{type:"left_arrow_black"}]}}),e._v(" "),o("div",{staticClass:"main"},[o("div",{staticClass:"redbagBag",class:{addHeight:!e.show1}},[o("div",{staticClass:"redbagTop"},[o("p",[o("span",[e._v("￥")]),e._v(e._s(e.redpPacket)+"\n        ")]),e._v(" "),o("div",{staticClass:"petrol"},[e._v("额度加油站")]),e._v(" "),o("div",{staticClass:"draw"},[e._v("领取有效期 "),o("span",[e._v(e._s(e.redbagDate))])])]),e._v(" "),e.show?o("div",{staticClass:"excrete"},[o("div",{staticClass:"noteVerify"},[o("p",[e._v("短信验证码：")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.wantAmt,expression:"wantAmt"}],attrs:{type:"text",maxlength:"6",placeholder:"请输入"},domProps:{value:e.wantAmt},on:{input:function(t){t.target.composing||(e.wantAmt=t.target.value)}}}),e._v(" "),o("div",{staticClass:"redbagBut",on:{click:function(t){e.getMsgCode()}}},[e._v(e._s(e.getCodeText))])]),e._v(" "),o("x-button",{staticClass:"promptly",attrs:{disabled:e.confirm,type:"warn"},nativeOn:{click:function(t){e.submitHongBao()}}},[e._v("\n          立即拆包\n        ")])],1):e._e(),e._v(" "),e.show1?o("div",{staticClass:"refuelBtn"},[o("x-button",{staticClass:"refuel",attrs:{disabled:e.prohibit},nativeOn:{click:function(t){e.promptlyRefuel()}}},[e._v("\n        "+e._s(e.refuelText)+"\n        ")])],1):e._e(),e._v(" "),o("confirm",{attrs:{"confirm-text":"添加"},on:{"on-confirm":e.toAddCard},model:{value:e.show2,callback:function(t){e.show2=t},expression:"show2"}},[o("div",{staticClass:"confirm-hint"},[o("p",[e._v(e._s(e.text))])])]),e._v(" "),o("div",[o("alert",{attrs:{"button-text":"关闭"},model:{value:e.show3,callback:function(t){e.show3=t},expression:"show3"}},[e._v(e._s(e.content))])],1)],1)])],1)},a=[],n={render:s,staticRenderFns:a};t.a=n},LDpO:function(e,t,o){"use strict";function s(e){o("nAbh")}Object.defineProperty(t,"__esModule",{value:!0});var a=(o("P9d7"),o("pa3i")),n=o("Kaep"),r=o("C7Lr"),i=s,c=r(a.a,n.a,!1,i,null,null);t.default=c.exports},P9d7:function(e,t,o){"use strict";var s=o("JGLT"),a=o("mqrw"),n=o("IXui"),r={},i=!0;s.a,a.a,n.a},nAbh:function(e,t){},pa3i:function(e,t,o){"use strict";var s=o("JGLT"),a=o("mqrw"),n=o("IXui"),r={},i=!0;t.a={name:"redbagInfo",data:function(){return{show:!1,show1:!0,show2:!1,show3:!1,date:"",redbagDate:"",prohibit:!1,refuelText:"领取红包",content:"",wantAmt:"",getCodeText:"获取",redpPacket:"",mobileNo:"",customerId:"",text:"",pageParams:this.$route.params.hbAccountNo?this.$route.params:{hbId:"",hbValidate:"20181231",hbAccountNo:"6234456789078908",hbForehead:"20000",credNo:""}}},components:{Confirm:s.a,Alert:a.a,XButton:n.a},computed:{getUserInfo:function(){return this.$store.getters.getStateKey("WL-Authentication-Success.UserInfoAuthRealm.attributes.data").data},confirm:function(){return 6!=this.wantAmt.length&&(this.wantAmt.length<6||""==this.wantAmt||this.wantAmt,!0)}},methods:{pageInit:function(){r=this.pageParams,i=!1,void 0!=r.hbId&&""!=r.hbId||(console.log("没有收到任何红包信息"),this.$vux.toast.show({text:"暂无额度信息!",type:"text"})),this.MSMH0042()},promptlyRefuel:function(){var e=this;console.log(r);window.client.request({ifpUrl:"/mp/MP0002.do",url:"/api/getLocalTime.json",success:function(t){console.log("我是服务器接口");var o=t.currentTime,s=new Date;s.setFullYear(o.substr(0,4),o.substr(4,2),o.substr(6,2));var a=r.hbValidate,n=new Date;n.setFullYear(a.substr(0,4),a.substr(4,2),a.substr(6,2)),n<s?(e.show3=!0,e.content="该红包已过期,无法使用"):0==e.getDate(o.substr(8,2),o.substr(10,2),o.substr(12,2))?(e.show3=!0,e.content="系统正在维护中,无法领取红包",console.log("跑批时间")):(console.log("非跑批时间"),e.MH0243())}})},MH0243:function(e){var t=this;console.log("我是MH0243接口"),this.mobileNo=this.getUserInfo.mobileNo,this.customerId=this.getUserInfo.customerId;var o="",s=r.hbId,a={tranCode:"MH0243",srcChannel:"MH",mobileNo:"",accountNo:r.hbAccountNo,customerId:this.customerId,redPocketId:s};window.client.request({ifpUrl:"/mp/MP1109.do",url:"/api/MH0243.json",adapter:"CommonAdapter",isLogin:!0,funName:"MH0243",parameters:a,success:function(e){switch(console.log("我是MH0243接口的状态"),o=e.redPocketAjustStatus,o+="",console.log(o),o){case"ERRO_NOT_MOBILE":t.show3=!0,t.content="调额信用卡没有绑定手机号,无法进行额度加油";break;case"0":t.cheer();break;case"1":t.$router.push({name:"redbag_info_repetitionGet"});break;case"2":t.show3=!0,t.content="连接超时,请稍后再试";break;case"3":t.cheer();break;case"4":t.$router.push({name:"redbag_info_beDefeated"});break;case"5":t.$router.push({name:"redbag_info_repetitionGet"});break;default:t.$router.push({name:"redbag_info_repetitionGet01"})}}})},getMsgCode:function(e){var t=this,o={mobileNo:"",tranCode:"MH0240",srcChannel:"MH",busCode:"RD",SMSID:"M1",TEMPLATEID:"081M100104",STDINFOTYP:encodeURI("额度加油"),smsLimitFlag:"N",SMSFlag:"1",accountNo:r.hbAccountNo};window.client.request({ifpUrl:"/mp/MP1108.do",url:"/api/MH0240.json",adapter:"CommonAdapter",funName:"second_MH0240",isLogin:!0,encrypt:!0,parameters:o,success:function(e){var o=e.optionFlag;if("获取"==t.getCodeText)if(console.log("短信状态为0"),0==o){console.log("验证码已经发送"),i=!0,t.$vux.toast.show({text:"已发送验证码,请查收!",type:"text"});var s=60;t.getCodeText=--s+"s";var a=setInterval(function(){t.getCodeText=--s+"s",s||(clearInterval(a),t.getCodeText="获取")},1e3)}else t.$vux.toast.show({text:"短信验证码超时，请重新发送",type:"text"});else t.$vux.toast.show({text:"请稍后再点击获取验证码!",type:"text"})}})},MH0244:function(e,t){var o=this,s={mobileNo:"",customerId:this.customerId,accountNo:r.hbAccountNo,redPocketId:r.hbId,expectAmt:r.hbForehead,adjustRsn:"HBTE",smsCode:e,tranCode:"MH0244",srcChannel:"MH",channelCode:"470",subCaseType:"0109",smsNotice:"1",currency:"156",busCode:"RD",requestType:"2"};window.client.request({ifpUrl:"/mp/MP1110.do",url:"/api/MH0244.json",adapter:"CommonAdapter",isLogin:!0,funName:"second_MH0244",encrypt:!0,parameters:s,processException:function(e){"PP010109"==e.errorCode||"PA040304"==e.errorCode?(i=!0,o.$vux.toast.show({text:"短信验证码不存在或已超时,请重新获取!",type:"text"})):"PP010110"==e.errorCode?(o.$vux.toast.show({text:"短信验证码错误,请重新输入!",type:"text"}),i=!0):"BP000100"==e.errorCode?o.$router.push({name:"redbag_info_beDefeated"}):"BP000446"==e.errorCode?o.$router.push({name:"redbag_info_repetitionGet"}):"EBLN2000"==e.errorCode||"BP000092"==e.errorCode||"BP000102"==e.errorCode||"BP000401"==e.errorCode||"BP00Q040"==e.errorCode||"BP000004"==e.errorCode?o.$router.push({name:"redbag_info_repetitionGet01"}):o.$router.push({name:"redbag_info_beDefeated"})},success:function(e){var t={redPocketAjustStatus:e.ec,sugPriAcctLimit:e.sugPriAcctLimit};console.log("验证码正确"+t.sugPriAcctLimit),o.$router.push({name:"redbag_info_succeedGet",params:t})}})},submitHongBao:function(){0==i?(console.log("没有获取短信验证码的弹窗！！！"),this.$vux.toast.show({text:"未获取短信验证码,请获取短信验证码后再点击!",type:"text"})):6!=this.wantAmt.length||1==isNaN(this.wantAmt)?this.$vux.toast.show({text:"验证码必须为6位数字!",type:"text"}):this.MH0244()},toAddCard:function(){this.$router.push({name:"cdbank_add_credit"})},cheer:function(){this.show1=!1,this.show=!0},getDate:function(e,t,o){var s=new Date;s.setHours(6),s.setMinutes(0),s.setSeconds(0);var a=new Date;a.setHours(23),a.setMinutes(30),a.setSeconds(0);var n=new Date;return n.setHours(e),n.setMinutes(t),n.setSeconds(o),!!(s<n&n<a)},MSMH0042:function(e){var t=this,o={tranCode:"MSMH0042",channel:"0"};window.client.request({ifpUrl:"/mp/MP2027.do",url:"/api/MSMH0042.json",adapter:"MPBank",funName:"second_MSMH0042",isLogin:!0,encrypt:!0,parameters:o,success:function(e){console.log("我是MH0042接口"),t.redpPacket=r.hbForehead,t.redbagDate=r.hbValidate.substr(0,4)+"-"+r.hbValidate.substr(4,2)+"-"+r.hbValidate.substr(6,2),console.log(t.redbagDate)}})}},created:function(){console.log(this.getUserInfo),this.pageInit(),this.MSMH0042(),this.getDate()}}}});