webpackJsonp([278],{"1uUn":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("xcgb-box",[a("xcgb-head",{attrs:{title:"身份验证",keepAlive:!1,leftOptions:[{type:"left_arrow_black"}]}}),t._v(" "),a("div",{staticClass:"main"},[a("div",{staticClass:"login-prompt"},[t._v("由于您在另一台设备上登陆过，为了您的交易安全，请先进行手机验证：")]),t._v(" "),a("group",{staticClass:"group"},[a("x-input",{attrs:{title:"短信验证码",placeholder:"请输入",max:6},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}},[a("x-button",{class:{active:t.bgChange},attrs:{slot:"right",type:"warn",mini:""},nativeOn:{click:function(e){return t.getToken(e)}},slot:"right"},[t.start?t._e():a("i",[t._v("获取")]),t._v(" "),t.start?a("countdown",{attrs:{start:t.start},on:{"on-finish":t.finish2},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}}):t._e(),t._v(" "),t.start?a("i",[t._v("秒")]):t._e()],1)],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tipsTxt,expression:"tipsTxt"}],staticClass:"validation-tips"},[a("p",[t._v(t._s(t.tipsText))])]),t._v(" "),a("div",{staticClass:"confirm"},[a("x-button",{attrs:{"action-type":"button",disabled:!t.token},nativeOn:{click:function(e){return t.confirm(e)}}},[t._v("确定")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.mask,expression:"mask"}],staticClass:"mask"},[a("div",{staticClass:"mask-tips"},[a("i",{directives:[{name:"show",rawName:"v-show",value:t.close,expression:"close"}],staticClass:"close",on:{click:t.maskConfirm}}),t._v(" "),a("p",[t._v(t._s(t.maskText))]),t._v(" "),a("x-button",{directives:[{name:"show",rawName:"v-show",value:t.submitAlert,expression:"submitAlert"}],staticClass:"submitAlert",attrs:{plain:""},nativeOn:{click:function(e){return t.maskConfirm(e)}}},[t._v("确认")]),t._v(" "),a("x-button",{directives:[{name:"show",rawName:"v-show",value:t.tipsAlert,expression:"tipsAlert"}],staticClass:"tipsAlert",attrs:{type:"warn"},nativeOn:{click:function(e){return t.maskConfirm(e)}}},[t._v("确认")])],1)])],1)],1)},n=[],i={render:s,staticRenderFns:n};e.a=i},S69L:function(t,e,a){"use strict";function s(t){a("vtGR")}Object.defineProperty(e,"__esModule",{value:!0});var n=(a("p8f4"),a("qVCc")),i=a("1uUn"),r=a("C7Lr"),o=s,c=r(n.a,i.a,!1,o,null,null);e.default=c.exports},nKQB:function(t,e,a){"use strict";a.d(e,"a",function(){return o}),a.d(e,"b",function(){return c});var s=a("3cXf"),n=a.n(s),i=a("NeOf"),r=function(t){return null==t||void 0==t?"":i.a.DES.encrypt(t,"cgbbank.credit.card.project.2016").toString()},o=function(t,e){if("json"!=e)return t+="",r(t);try{var a=n()(t);return r(a)}catch(t){return"-1"}},c=function(t,e){var a="";switch(t){case"EBMB9018":a="当前业务您已连续获取10次短信验证码未验证通过了，请您明天再来。";break;case"PP010110":case"EBMB2055":case"EMSBNULL":case"PA040304":a="短信验证码输入有误，请重新输入。";break;case"PP010109":a="您的短信验证码输入有误或已超时，请重新输入。";break;case"EBMB2054":a="短信验证码已超时，请重新获取，谢谢！";break;case"CW0000P7":case"CW0000P9":case"CW0000P8":a="亲，您的美元账户有欠款或存款，无法开通人民币世界通服务。";break;case"CW000045":a="亲，您的卡片目前已超额，请还款后再申请哦!";break;default:a=e}return a}},p8f4:function(t,e,a){"use strict";var s=a("4YfN"),n=a.n(s),i=a("CKVb"),r=a("fvyU"),o=a("IXui"),c=a("f4gh"),u=a("Nqtu"),l=a("NeOf"),m=a("nKQB");i.a,r.a,o.a,c.a,u.a},qVCc:function(t,e,a){"use strict";var s=a("4YfN"),n=a.n(s),i=a("CKVb"),r=a("fvyU"),o=a("IXui"),c=a("f4gh"),u=a("Nqtu"),l=a("NeOf"),m=a("nKQB");e.a={name:"authentication",data:function(){return{token:"",time:60,start:!1,tipsText:"",mask:!1,maskText:"",bgChange:!1,mobileNo:this.$route.params.param.mobileNo,tipsTxt:!1,close:!1,submitAlert:!0,tipsAlert:!1}},components:{Group:i.a,XInput:r.a,XButton:o.a,Toast:c.a,Countdown:u.a},methods:{finish2:function(t){this.start=!1,this.bgChange=!1,this.time=60},getToken:function(){var t=this,e=l.a.DES.encrypt(this.mobileNo,"cgbbank.credit.card.project.2016");window.client.request({url:"/api/MH0009.json",adapter:"CommonAdapter",procedure:"control",parameters:{funName:"second_MH0009",type:"json",value:e.toString(),transferFlowNoNew:(new Date).getTime()}}).then(function(e){console.log(e);var s=e.invocationResult.root;0===s.ec||"0"===s.ec?(t.tipsTxt=!0,"1"===s.cd.optionFlag||1===s.cd.optionFlag?(t.mask=!0,t.maskText="您刚已获取了短信验证码，无需重新获取。"):(t.start=!0,t.bgChange=!0,t.tipsText="已向尾号为"+t.mobileNo.slice(t.mobileNo.length-4)+"的手机号码发送验证码，60s后方能重新获取，短信验证码120秒内有效。")):(t.mask=!0,t.maskText=a.i(m.b)(s.ec,s.em))})},maskConfirm:function(){this.mask=!1},checkToken:function(t){var e=/^[0-9]{6}$/;return t?t.length<6?(this.mask=!0,this.maskText="短信验证码长度不能小于6位，请重新输入。",!1):!!e.test(t)||(this.mask=!0,this.maskText="短信验证码输入错误，请重新输入。",!1):(this.mask=!0,this.maskText="短信验证码不能为空，请重新输入。",!1)},confirm:function(){var t=this;this.checkToken(this.token)&&window.client.getClientInfo().then(function(e){var a={adapter:"CommonAdapter",procedure:"MH0010",parameters:{smsCode:t.token,equipment_id:e.equipment_id,busCode:"04",mobileNo:t.mobileNo,tranCode:"MH0010",logonType:t.$route.params.param.userLogonType,imei:"",userIP:e.IP}};window.client.request(n()({url:"/api/MH0010.json"},a)).then(function(e){var a=e.invocationResult.root;if(0==a.ec||"0"==a.ec){t.$store.commit("setUserInfo",t.$route.params.res);var s={};"00"==t.$route.params.param.userLogonType&&(s={mobileNo:t.$route.params.param.lastLoginUser,groupFlag:t.$route.params.param.groupFlag},localStorage.setItem("lastLoginUserCertNo",t.$route.params.res["WL-Authentication-Success"].UserInfoAuthRealm.attributes.data.certNo),localStorage.setItem("lastLoginUserCertType",t.$route.params.res["WL-Authentication-Success"].UserInfoAuthRealm.attributes.data.certType),localStorage.setItem("lastLoginUser",s.mobileNo),localStorage.setItem("lastLoginDate",t.$route.params.param.lastLoginDate)),t.$router.push({name:"home_site"})}else t.mask=!0,t.maskText=t.errmsg(a.ec,a.em)})})}}}},vtGR:function(t,e){}});