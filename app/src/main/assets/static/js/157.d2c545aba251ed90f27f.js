webpackJsonp([157],{"2fwJ":function(t,e,s){"use strict";function a(t){s("s13D")}Object.defineProperty(e,"__esModule",{value:!0});var i=(s("igkk"),s("yPzF")),n=s("xV22"),o=s("C7Lr"),r=a,l=o(i.a,n.a,!1,r,"data-v-e54026ae",null);e.default=l.exports},"45uB":function(t,e,s){"use strict";var a=s("7+S+");e.a={name:"cell-box",props:{isLink:Boolean,link:[String,Object],borderIntent:{type:Boolean,default:!0},noFlex:Boolean,alignItems:String},computed:{style:function(){if(this.alignItems)return{"align-items":this.alignItems}},className:function(){return{"vux-tap-active":this.isLink||!!this.link,"weui-cell_access":this.isLink||!!this.link,"vux-cell-no-border-intent":!this.borderIntent}}},methods:{onClick:function(){this.link&&s.i(a.a)(this.link,this.$router)}}}},goqb:function(t,e,s){t.exports=s.p+"static/img/view03_phone.png"},igkk:function(t,e,s){"use strict";var a=s("CKVb"),i=s("gpPJ"),n=s("swb9");a.a,i.a,n.a},kauM:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"vux-cell-box weui-cell",class:t.className,style:t.style,on:{click:t.onClick}},[t._t("default")],2)},i=[],n={render:a,staticRenderFns:i};e.a=n},s13D:function(t,e){},s43q:function(t,e){},swb9:function(t,e,s){"use strict";function a(t){s("s43q")}var i=(s("vSXs"),s("45uB")),n=s("kauM"),o=s("C7Lr"),r=a,l=o(i.a,n.a,!1,r,null,null);e.a=l.exports},vSXs:function(t,e,s){"use strict";var a=s("7+S+");Boolean,String,Object,Boolean,Boolean,String},xV22:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("xcgb-box",[a("xcgb-head",{attrs:{title:"详情",alpha:1,keepAlive:!1,leftOptions:[{type:"left_arrow_black"}]}}),t._v(" "),a("div",{staticClass:"main"},[a("div",[a("div",{staticClass:"goodsHeader"},[a("img",{staticClass:"img",attrs:{src:t.info.imgUrl}}),t._v(" "),a("div",{staticClass:"name"},[a("div",[t._v(t._s(t.info.serviceName))])])]),t._v(" "),a("group",{attrs:{gutter:"0"}},[a("cell",[a("div",{staticClass:"cell1Left",attrs:{slot:"title"},slot:"title"},[a("div",{class:{none:!t.info.tempFlag3}},[t._v("随时退")]),t._v(" "),a("div",{class:{none:!t.info.tempFlag4}},[t._v("免预约")])]),t._v(" "),a("div",{staticClass:"cell1Right"},[a("div",[t._v(t._s(0===t.params.type?"已售":"剩余"))]),t._v(" "),a("div",[t._v(t._s(t.info.soldAmt))])])])],1),t._v(" "),0===t.params.type?a("group",[a("cell-box",[a("div",{staticClass:"groupTitle"},[t._v("付款方式")])]),t._v(" "),a("cell-box",[a("div",{staticClass:"paymentRadio"},[t.info.payType&&"1"===t.info.payType[0]?a("div",[t._v("广发信用卡")]):t._e(),t._v(" "),t.info.payType&&"1"===t.info.payType[2]?a("div",[t._v("广发信用卡+积分")]):t._e(),t._v(" "),t.info.payType&&"1"===t.info.payType[1]?a("div",[t._v("积分")]):t._e(),t._v(" "),t.info.payType&&"1"===t.info.payType[3]?a("div",[t._v("卡积分")]):t._e()])])],1):t._e(),t._v(" "),a("group",[t.shopDetails?a("cell",{attrs:{title:"可用门店"}}):t._e(),t._v(" "),t.shopDetails?a("cell-box",[a("div",{staticClass:"storeInfo"},[a("div",[t._v(t._s(t.shopDetails.name))]),t._v(" "),a("div",[a("div",[a("div",[t._v(t._s(t.shopDetails.address))]),t._v(" "),a("div",[t._v(t._s(t.shopDetails.distance)+"m "),a("span",[t._v("离我最近")])])]),t._v(" "),a("div",[a("img",{attrs:{src:s("goqb")}})])])])]):t._e(),t._v(" "),a("cell",{attrs:{"is-link":"",title:"查看全部门店"}})],1),t._v(" "),a("group",{staticClass:"mbottom"},[a("cell",{attrs:{title:"购买须知"}}),t._v(" "),a("cell-box",{staticClass:"notes"},[a("div",[a("div",{staticClass:"title"},[t._v("有效期")]),t._v(" "),a("div",{staticClass:"info"},[t._v(t._s(t.info.beginDate)+"--"+t._s(t.info.endDate))]),t._v(" "),a("div",{staticClass:"title"},[t._v("商品描述")]),t._v(" "),a("div",{staticClass:"info"},[t._v(t._s(t.info.serviceAbstruct))])])])],1)],1)]),t._v(" "),a("div",[a("group",{staticStyle:{"border-top":"1px solid #e5e5e5"},attrs:{gutter:"0"}},[a("cell",[a("div",{staticClass:"price",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.info.subscribeAmt))]),t._v(" "),a("div",{staticClass:"btn",class:{none:0!==t.btnState},on:{click:t.buy}},[t._v(t._s(t.btnMsg))])])],1)],1)],1)},i=[],n={render:a,staticRenderFns:i};e.a=n},yPzF:function(t,e,s){"use strict";var a=s("CKVb"),i=s("gpPJ"),n=s("swb9");e.a={components:{Group:a.a,Cell:i.a,CellBox:n.a},name:"detail",data:function(){return{params:null,info:{},shopDetails:null,btnState:0,btnMsg:"立即抢购"}},created:function(){this.params=this.$route.params,0===this.params.type?this.loadMH0637():this.loadMSMH0045(),this.loadMSMH0047()},methods:{loadMH0637:function(){window.client.request({url:"/api/MH0637.json",adapter:"CommonAdapter",isLogin:!0,funName:"MH0637",encrypt:!0,parameters:{ServiceId:this.params.mbaId},success:function(t){if("0"===t.root.ec){var e=t.root.cd;1*e.totalNum-1*e.soldAmt<=0?(this.btnState=1,this.btnMsg="抢光了"):1*e.beginDate>1*e.endDate||"01"===e.state?(this.btnState=2,this.btnMsg="活动未开始"):"20"===e.state&&(this.btnState=3,this.btnMsg="活动已结束"),this.info={serviceName:e.serviceName,serviceAbstruct:e.serviceAbstruct,totalNum:e.totalNum,count:e.count,beginDate:e.beginDate.substr(0,4)+"."+e.beginDate.substr(4,2)+"."+e.beginDate.substr(6,2),endDate:e.endDate.substr(0,4)+"."+e.endDate.substr(4,2)+"."+e.endDate.substr(6,2),payType:e.payType.substr(0,4).split(""),subscribeAmt:(e.subscribeAmt/100).toFixed(2),tempFlag3:"1"===e.tempFlag3,tempFlag4:"1"===e.tempFlag4,soldAmt:1*e.soldAmt,imgUrl:e.imgUrl}}}.bind(this)})},loadMSMH0047:function(){window.client.request({url:"/api/MSMH0047.json",adapter:"CommonAdapter",isLogin:!0,funName:"MSMH0047",encrypt:!0,parameters:{longitude:"",latitude:"",mbaId:this.params.mbaId,srcChannel:"MH",tranCode:"MSMH0047",sortMode:"3"},success:function(t){if("0"===t.root.ec){var e=t.root.cd.result.kColl;e.cmi_merchant_name&&(this.shopDetails={name:e.cmi_merchant_name,address:e.mmi_merchant_addr,tel:e.cmi_tel,distance:e.web_distance,point:e.mmi_piont})}}.bind(this)})},loadMSMH0045:function(){window.client.request({url:"/api/MSMH0045.json",adapter:"CommonAdapter",isLogin:!0,funName:"MSMH0045",encrypt:!0,parameters:{tranCode:"MSMH0045",srcChannel:"MH",mbaChannel:"MH",mbaId:this.params.dataId+"",mbaCouponBatchId:this.params.mbaCouponBatchId+"",mbaMallGoodsId:this.params.mbaMallGoodsId+"",mbaType:"1"},success:function(t){if("0"===t.root.ec){var e=t.root.cd;console.log(e),this.info={serviceName:e.mbaName,soldAmt:1*e.mbaQuota,serviceAbstruct:e.mbaGoodsDesc,beginDate:e.mbaStarttime.substr(0,4)+"."+e.mbaStarttime.substr(4,2)+"."+e.mbaStarttime.substr(6,2),endDate:e.mbaEndtime.substr(0,4)+"."+e.mbaEndtime.substr(4,2)+"."+e.mbaEndtime.substr(6,2),tempFlag3:"0"===e.mbaIsRefund,tempFlag4:"1"===e.mbaIsBespeak,payType:["0","0","0","0"],imgUrl:e.mbaActDetailImg,subscribeAmt:0,mbaId:e.mbaId};var s=t.serverTime.ymdms;1*e.drawNum>=1*e.mbaQuota?(this.btnMsg="抢光了",this.btnState=1):1*e.mbaStarttime>1*s&&(this.btnState=1,this.btnMsg="活动未开始")}}.bind(this)})},buy:function(){0===this.btnState&&(0===this.params.type||this.freeCoupon())},freeCoupon:function(){var t={tranCode:"MSMH0062",act_id:this.info.mbaId,srcChannel:"MH",mobileNo:"",cardType:"",cardNo:""};window.client.request({url:"/api/MSMH0062.json",adapter:"CommonAdapter",isLogin:!0,funName:"MSMH0062",encrypt:!0,parameters:t,success:function(t){"0"===t.root.ec&&console.log(t.root.ec)}})}}}}});